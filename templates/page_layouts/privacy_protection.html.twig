{% extends 'page_layouts/base.html.twig' %}
{% set page_works_without_js = false %}

{% block scripts %}
	<script id="privacy_opt_out" data-tracking_url="{$ piwik.baseUrl $}" src="{$ basepath $}/skins/laika/js/privacy_protection.js"></script>
{% endblock %}

{% block main %}
	{# Writing opt-out wrapper into variable before injecting it into content page via string replace #}
	{% set matomo_opt_out %}
		<div class="privacy_wrapper">
			<h2>Datenerhebung</h2>
			<p class="legend">
				$t('privacy_optout_description')
			</p>
			<div class="privacy_selection">
				<div class="privacy_selection_box">
					<div class="choice-in">
						<input name="matomo_choice" id="tracking-opt-in" value="0" type="radio">
						<label for="tracking-opt-in"><span>$t('privacy_optout_tracking_permit')</span></label>
					</div>
					<div class="choice-out">
						<input name="matomo_choice" id="tracking-opt-out" value="1" type="radio">
						<label for="tracking-opt-out"><span>$t('privacy_optout_tracking_deny')</span></label>
					</div>
				</div>
				<div class="privacy_explanation">
					<p>
						$t('privacy_optout_tracking_state')
					</p>
				</div>
			</div>
		</div>
	{% endset %}
	{% set content = web_content("pages/#{page_id}") | replace({'<!-- placeholder_matomo -->': matomo_opt_out}) | raw %}
	<div id="app"
		data-page-id="{$ page_id $}"
		data-page-title="{$ title | e('html_attr') $}"
		data-page-content="{$ content | e('html_attr') | raw $}"
		data-application-vars="{$ _context|json_encode|e('html_attr') $}" 
   		data-application-messages="{$ translations()|e('html_attr') $}" 
    	data-assets-path="{% if assets_path %}{$ assets_path $}{% else %}{$ basepath $}/skins/laika{% endif %}">
	</div>
{% endblock %}